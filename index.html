<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Miguel's L√§nderanalyse ‚Äì Check-Quiz + Comments (v2)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #020617;
      color: #f9fafb;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      padding: 16px;
    }
    .app {
      width: 100%;
      max-width: 880px;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 8px;
      flex-wrap: wrap;
    }
    .brand {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .brand-title {
      font-size: 1.4rem;
      font-weight: 700;
    }
    .brand-sub {
      font-size: 0.8rem;
      color: #9ca3af;
    }
    .badge {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #4b5563;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      background: radial-gradient(circle at top, #111827, #020617);
    }
    .subtitle {
      font-size: 0.85rem;
      color: #9ca3af;
      margin-bottom: 14px;
    }
    .layout {
      display: grid;
      grid-template-columns: minmax(0, 2.2fr) minmax(0, 1.5fr);
      gap: 14px;
    }
    @media (max-width: 900px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }
    .card {
      background: radial-gradient(circle at top, #0f172a, #020617);
      border-radius: 18px;
      padding: 18px 16px 14px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.6);
      border: 1px solid #1f2937;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .tag-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
      font-size: 0.8rem;
      color: #9ca3af;
      flex-wrap: wrap;
      gap: 6px;
    }
    .pill {
      padding: 2px 10px;
      border-radius: 999px;
      border: 1px solid #374151;
      background: rgba(15,23,42,0.9);
      font-size: 0.75rem;
    }
    .counter {
      font-size: 0.8rem;
    }
    .status-pill {
      padding: 2px 10px;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid transparent;
    }
    .status-none { display: none; }
    .status-correct {
      display: inline-block;
      background: rgba(22,163,74,0.15);
      border-color: #16a34a;
      color: #bbf7d0;
    }
    .status-partial {
      display: inline-block;
      background: rgba(234,179,8,0.15);
      border-color: #eab308;
      color: #facc15;
    }
    .status-wrong {
      display: inline-block;
      background: rgba(239,68,68,0.15);
      border-color: #ef4444;
      color: #fecaca;
    }
    .question {
      font-size: 1rem;
      line-height: 1.4;
      font-weight: 500;
    }
    textarea {
      width: 100%;
      min-height: 90px;
      border-radius: 12px;
      border: 1px solid #1f2937;
      background: rgba(15,23,42,0.9);
      color: #e5e7eb;
      padding: 8px 10px;
      font-family: inherit;
      font-size: 0.9rem;
      resize: vertical;
    }
    textarea:focus {
      outline: none;
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px rgba(79,70,229,0.5);
    }
    .label {
      font-size: 0.8rem;
      color: #9ca3af;
      margin-bottom: 2px;
    }
    .result {
      font-size: 0.9rem;
      line-height: 1.4;
      border-radius: 10px;
      padding: 8px 10px;
      display: none;
      margin-top: 4px;
    }
    .result.visible { display: block; }
    .result.correct {
      background: rgba(22,163,74,0.12);
      border: 1px solid #16a34a;
      color: #bbf7d0;
    }
    .result.partial {
      background: rgba(234,179,8,0.1);
      border: 1px solid #eab308;
      color: #facc15;
    }
    .result.wrong {
      background: rgba(248,113,113,0.13);
      border: 1px solid #ef4444;
      color: #fecaca;
    }
    .solution {
      margin-top: 6px;
      font-size: 0.85rem;
      color: #e5e7eb;
    }
    .controls {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      margin-top: 4px;
      flex-wrap: wrap;
    }
    button {
      flex: 1;
      padding: 9px 10px;
      border-radius: 999px;
      border: none;
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      background: #111827;
      color: #e5e7eb;
      border: 1px solid #1f2937;
      transition: background 0.15s, transform 0.1s, border-color 0.15s;
    }
    button.primary {
      background: linear-gradient(135deg, #4f46e5, #06b6d4);
      border-color: transparent;
      color: white;
    }
    button.accent {
      background: linear-gradient(135deg, #22c55e, #14b8a6);
      border-color: transparent;
      color: #ecfdf5;
    }
    button.small {
      flex: 0;
      padding-inline: 10px;
      font-size: 0.75rem;
    }
    button:active {
      transform: scale(0.97);
    }
    .hint {
      margin-top: 8px;
      font-size: 0.75rem;
      color: #9ca3af;
    }
    .score-row {
      display: flex;
      gap: 10px;
      font-size: 0.75rem;
      color: #9ca3af;
      margin-bottom: 6px;
      flex-wrap: wrap;
    }
    .score-pill {
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid #374151;
      background: rgba(15,23,42,0.9);
    }
    .score-pill span { font-weight: 600; }

    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,0.98);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 20;
    }
    .setup-card {
      background: radial-gradient(circle at top, #0b1120, #020617);
      border-radius: 18px;
      padding: 18px 16px 18px;
      border: 1px solid #1f2937;
      width: 100%;
      max-width: 420px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.7);
    }
    .setup-title {
      font-size: 1.1rem;
      margin-bottom: 8px;
      font-weight: 600;
    }
    .setup-row {
      margin-top: 10px;
      margin-bottom: 6px;
    }
    input[type="text"] {
      width: 100%;
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: rgba(15,23,42,0.9);
      color: #e5e7eb;
      padding: 8px 12px;
      font-size: 0.9rem;
    }
    input[type="text"]:focus {
      outline: none;
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px rgba(79,70,229,0.5);
    }
    .avatar-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 8px;
      margin-top: 6px;
    }
    .avatar-option {
      cursor: pointer;
      border-radius: 12px;
      padding: 6px 4px;
      text-align: center;
      border: 1px solid #1f2937;
      background: radial-gradient(circle at top, #020617, #020617);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      font-size: 0.7rem;
      color: #9ca3af;
      transition: border-color 0.15s, transform 0.1s, box-shadow 0.15s;
    }
    .avatar-option span.emoji {
      font-size: 1.6rem;
    }
    .avatar-option.selected {
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px rgba(79,70,229,0.5);
      transform: translateY(-1px);
      background: radial-gradient(circle at top, #111827, #020617);
      color: #e5e7eb;
    }
    #countdownDisplay {
      display: none;
      text-align: center;
      font-size: 2.3rem;
      margin-top: 16px;
      font-weight: 700;
    }

    .comments-card {
      background: radial-gradient(circle at top, #020617, #020617);
      border-radius: 18px;
      padding: 14px 12px 10px;
      border: 1px solid #1f2937;
      max-height: 540px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .comments-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }
    .comments-title {
      font-size: 0.95rem;
      font-weight: 600;
    }
    .comment-info {
      font-size: 0.7rem;
      color: #9ca3af;
    }
    .summary-box {
      font-size: 0.8rem;
      border-radius: 12px;
      padding: 8px 10px;
      border: 1px dashed #374151;
      background: rgba(15,23,42,0.9);
    }
    .summary-box strong { font-weight: 600; }
    .comment-form {
      margin-top: 6px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .comment-list {
      margin-top: 6px;
      padding-top: 6px;
      border-top: 1px solid #111827;
      overflow-y: auto;
      flex: 1;
    }
    .comment-item {
      display: flex;
      gap: 8px;
      padding: 6px 4px;
      border-radius: 10px;
      border: 1px solid #111827;
      background: rgba(15,23,42,0.9);
      margin-bottom: 6px;
    }
    .comment-avatar {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      background: radial-gradient(circle at top, #111827, #020617);
      flex-shrink: 0;
    }
    .comment-body {
      font-size: 0.8rem;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .comment-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 4px;
      flex-wrap: wrap;
    }
    .comment-name {
      font-weight: 600;
      font-size: 0.8rem;
    }
    .comment-score {
      font-size: 0.75rem;
      color: #9ca3af;
    }
    .comment-text {
      font-size: 0.8rem;
      color: #e5e7eb;
      margin-top: 2px;
      white-space: pre-wrap;
    }
    .comment-timestamp {
      font-size: 0.7rem;
      color: #6b7280;
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="brand-title">Miguel's L√§nderanalyse</div>
        <div class="brand-sub">Emerging Asia ‚Ä¢ Check-Quiz mit Kommentaren</div>
      </div>
      <div class="badge">HRW ‚Ä¢ WS 25/26</div>
    </header>
    <p class="subtitle">
      Vor dem Quiz Namen & Avatar w√§hlen. Am Ende kannst du mit deinem Score einen Kommentar dalassen ‚Äì z.‚ÄØB. wie schwer es war.
    </p>

    <div class="layout">
      <div>
        <div class="score-row">
          <div class="score-pill">‚úÖ Richtig: <span id="scoreCorrect">0</span></div>
          <div class="score-pill">üü° Teilweise: <span id="scorePartial">0</span></div>
          <div class="score-pill">‚ùå Falsch: <span id="scoreWrong">0</span></div>
        </div>

        <div class="card" id="quizCard">
          <div>
            <div class="tag-row">
              <span class="pill" id="topicPill">Thema</span>
              <span class="counter" id="counter">1 / 1</span>
              <span class="status-pill status-none" id="statusPill"></span>
            </div>
            <div class="question" id="questionText"></div>
          </div>

          <div>
            <div class="label">Deine Antwort:</div>
            <textarea id="userAnswer" placeholder="Schreib deine Definition/Erkl√§rung hier rein..."></textarea>
          </div>

          <div>
            <button class="primary" id="checkBtn">Pr√ºfen</button>
            <div class="result" id="resultBox">
              <div id="resultText"></div>
              <div class="solution">
                Musterl√∂sung:<br>
                <span id="solutionText"></span>
              </div>
            </div>
          </div>

          <div class="controls">
            <button id="prevBtn">‚üµ Zur√ºck</button>
            <button id="clearBtn">Antwort l√∂schen</button>
            <button id="nextBtn">Weiter ‚ü∂</button>
            <button class="small" id="shuffleBtn">üîÄ Shuffle</button>
          </div>

          <div class="controls" style="margin-top:4px;">
            <button class="accent" id="finishBtn">Quiz beenden & kommentieren</button>
          </div>

          <p class="hint">
            Tipp: Nutze Fachbegriffe (‚Äû√úbergang‚Äú, ‚ÄûIndustrieland‚Äú, ‚ÄûFDI‚Äú, ‚ÄûSoft Power‚Äú usw.) ‚Äì genau darauf achtet der Checker.
          </p>
        </div>
      </div>

      <div>
        <div class="comments-card">
          <div class="comments-header">
            <div>
              <div class="comments-title">Kommentare zum Quiz</div>
              <div class="comment-info" id="userInfoText"></div>
            </div>
          </div>

          <div class="summary-box" id="summaryBox">
            <strong>Dein aktueller Score:</strong>
            <div>‚úÖ Richtig: <span id="sumCorrect">0</span> ‚Ä¢ üü° Teilweise: <span id="sumPartial">0</span> ‚Ä¢ ‚ùå Falsch: <span id="sumWrong">0</span></div>
            <div style="margin-top:4px;font-size:0.75rem;color:#9ca3af;">
              Wenn du zufrieden bist, schreib unten einen kurzen Kommentar (z.‚ÄØB. was schwer war oder was du noch wiederholen musst).
            </div>
          </div>

          <form class="comment-form" id="commentForm">
            <textarea id="commentInput" rows="3" placeholder="Dein Kommentar zum Quiz (z.‚ÄØB. ‚ÄûSoft Power war bisschen tricky‚Äú)..."></textarea>
            <button type="submit" class="primary">Kommentar mit Score posten</button>
          </form>

          <div class="comment-list" id="commentList">
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="overlay" id="setupOverlay">
    <div class="setup-card">
      <div class="setup-title">Bevor es losgeht üîë</div>
      <p class="subtitle" style="margin-bottom:6px;">
        W√§hle einen Namen & ein Avatar-Face. Danach startet ein kurzer 3‚Äë2‚Äë1 Countdown und das Quiz geht los.
      </p>

      <div class="setup-row" id="setupNameRow">
        <div class="label">Dein Name (f√ºr Kommentare):</div>
        <input type="text" id="nameInput" placeholder="z.‚ÄØB. Miguel" />
      </div>

      <div class="setup-row" id="setupAvatarRow">
        <div class="label">W√§hle ein Anime-Style Avatar üòà</div>
        <div class="avatar-grid" id="avatarGrid">
          <div class="avatar-option selected" data-index="0">
            <span class="emoji">üòº</span>
            <span>Tryhard Cat</span>
          </div>
          <div class="avatar-option" data-index="1">
            <span class="emoji">üòà</span>
            <span>Villain Arc</span>
          </div>
          <div class="avatar-option" data-index="2">
            <span class="emoji">ü§ì</span>
            <span>Study Demon</span>
          </div>
          <div class="avatar-option" data-index="3">
            <span class="emoji">üò¥</span>
            <span>Sleepy Pro</span>
          </div>
        </div>
      </div>

      <div id="countdownDisplay">3</div>

      <div class="setup-row" id="setupButtonRow" style="margin-top:12px;">
        <button class="primary" id="startQuizBtn">Quiz starten</button>
      </div>
    </div>
  </div>

  <script>
    const questions = [
      {
        topic: "Emerging Markets",
        q: "Definiere: Was sind Emerging Markets?",
        solution: "L√§nder, die sich im √úbergang vom Entwicklungsland zum Industrieland befinden ‚Äì mit wachsendem Einkommen, Industrialisierung und st√§rkerer Einbindung in die Weltwirtschaft.",
        keywords: [
          ["√ºbergang", "transition"],
          ["entwicklungsland", "developing"],
          ["industrieland", "industrial", "entwickeltes land"],
          ["wachstum", "wachsende", "einkommen", "wohlstand"]
        ]
      },
      {
        topic: "Emerging Markets",
        q: "Nenne typische Merkmale von Emerging Markets.",
        solution: "√úberdurchschnittliches Wachstumspotenzial, gro√üe Markt- und Expansionschancen f√ºr Unternehmen und Bedarf an speziellen Internationalisierungsstrategien.",
        keywords: [
          ["wachstum", "wachstumspotenzial"],
          ["markt", "marktpote", "expansions"],
          ["internationalisierung", "strategie", "strategien"]
        ]
      },
      {
        topic: "Emerging Asia",
        q: "Was versteht man unter ‚ÄûEmerging Asia‚Äú und welche L√§nder geh√∂ren typischerweise dazu?",
        solution: "Eine Gruppe dynamisch wachsender asiatischer Volkswirtschaften, meist China, Indien, Malaysia, Thailand, Vietnam und die Philippinen.",
        keywords: [
          ["dynamisch", "wachsend"],
          ["asiatisch", "asien"],
          ["china", "indien", "malaysia", "thailand", "vietnam", "philippinen"]
        ]
      },
      {
        topic: "L√§nderklassifikation",
        q: "Wie klassifiziert die Weltbank L√§nder nach Einkommen?",
        solution: "Nach dem GNI pro Kopf (Einkommensniveau) in die Gruppen: Low Income, Lower Middle Income, Upper Middle Income und High Income.",
        keywords: [
          ["weltbank"],
          ["gni", "einkommen", "pro kopf"],
          ["low income", "low-income", "niedrig"],
          ["middle income", "lower middle", "upper middle"],
          ["high income", "hoch einkommen"]
        ]
      },
      {
        topic: "L√§nderklassifikation",
        q: "Wie teilt die UNO L√§nder nach Entwicklungsstand ein?",
        solution: "In Low Human Development, Medium Human Development und High Human Development, oft gemessen am Human Development Index (HDI).",
        keywords: [
          ["uno", "un"],
          ["low human", "niedriges human"],
          ["medium human", "mittleres human"],
          ["high human", "hohes human"],
          ["hdi", "human development index"]
        ]
      },
      {
        topic: "L√§nderklassifikation",
        q: "Welche drei Gruppen verwendet der IMF f√ºr L√§nder?",
        solution: "Low Income Developing Countries, Emerging Economies und Advanced Countries.",
        keywords: [
          ["imf", "iwf"],
          ["low income"],
          ["emerging"],
          ["advanced"]
        ]
      },
      {
        topic: "Wirtschaftlicher Aufstieg",
        q: "Erkl√§re BIP pro Kopf (GDP per capita) und warum es wichtig ist.",
        solution: "BIP pro Kopf ist das Bruttoinlandsprodukt geteilt durch die Bev√∂lkerungszahl und beschreibt die durchschnittliche Wirtschaftsleistung bzw. den Wohlstand pro Einwohner.",
        keywords: [
          ["bip pro kopf", "gdp per capita"],
          ["bruttoinlandsprodukt", "bip"],
          ["bev√∂lkerung", "einwohner"],
          ["durchschnitt", "wohlstand"]
        ]
      },
      {
        topic: "Wirtschaftlicher Aufstieg",
        q: "Nenne mehrere Indikatoren, mit denen man den wirtschaftlichen Aufstieg asiatischer L√§nder beschreiben kann.",
        solution: "BIP pro Kopf, BIP-Wachstum, Sektorenstruktur, Au√üenhandelsquote und ausl√§ndische Direktinvestitionen (FDI/ADI).",
        keywords: [
          ["bip pro kopf", "gdp per capita"],
          ["wachstum", "bip-wachstum"],
          ["sektorenstruktur", "sektor"],
          ["au√üenhandelsquote", "au√üenhandel"],
          ["fdi", "adi", "direktinvestition"]
        ]
      },
      {
        topic: "Flugg√§nsemodell",
        q: "Beschreibe das Flugg√§nsemodell in 2‚Äì3 S√§tzen.",
        solution: "Ein Leitland wie Japan entwickelt bestimmte Industrien zuerst, importiert Rohstoffe, produziert und exportiert Industrieprodukte. Wenn L√∂hne steigen, werden arbeitsintensive Produktionen in L√§nder mit niedrigeren L√∂hnen verlagert. Diese Nachfolgel√§nder holen technologisch auf und durchlaufen √§hnliche Entwicklungsstufen.",
        keywords: [
          ["leitland", "f√ºhrendes land", "japan"],
          ["rohstoffe", "import"],
          ["produktion", "industrieprodukte", "export"],
          ["l√∂hne", "lohnkosten", "steigend"],
          ["verlagert", "verlagerung"],
          ["√§rmere l√§nder", "niedrigere l√∂hne", "nachfolgel√§nder"]
        ]
      },
      {
        topic: "Zwischenstaatliche Beziehungen",
        q: "Z√§hle die vier Teilbereiche der zwischenstaatlichen Wirtschaftsbeziehungen auf.",
        solution: "Handel, Direktinvestitionen, Institutionen bzw. Wirtschaftsabkommen und das Gesch√§ftsklima.",
        keywords: [
          ["handel"],
          ["direktinvestition", "fdi"],
          ["institution", "wirtschaftsabkommen", "freihandel", "wto"],
          ["gesch√§ftsklima", "business climate"]
        ]
      },
      {
        topic: "Handel",
        q: "Erkl√§re Handelsvolumen, Handelsbilanz und Handelsstruktur.",
        solution: "Handelsvolumen ist Export plus Import. Die Handelsbilanz ist Export minus Import (√úberschuss bei mehr Exporten, Defizit bei mehr Importen). Die Handelsstruktur beschreibt, welche Arten von G√ºtern gehandelt werden, z. B. einfache Rohstoffe oder Hightech-Produkte.",
        keywords: [
          ["handelsvolumen", "export + import"],
          ["handelsbilanz", "export - import"],
          ["√ºberschuss", "defizit"],
          ["handelsstruktur", "g√ºterstruktur", "arten von g√ºtern"]
        ]
      },
      {
        topic: "Bedeutung Asiens",
        q: "Nenne die wichtigsten Gr√ºnde, warum Asien f√ºr die deutsche Wirtschaft wichtig ist.",
        solution: "Asien ist ein zentraler Handelspartner (Export von Autos, Maschinen, Hightech; Import von Elektronik, Textilien, Vorprodukten), Produktionsstandort in globalen Lieferketten und bietet wachsende Zukunftsm√§rkte durch steigende Mittelschichten und Infrastrukturbedarf.",
        keywords: [
          ["handelspartner", "handel"],
          ["autos", "maschinen", "hightech", "chemie"],
          ["elektronik", "textilien", "konsumg√ºter", "vorprodukte"],
          ["produktion", "lieferkette", "supply chain"],
          ["wachstum", "zukunftsm√§rkte", "mittelschicht"]
        ]
      },
      {
        topic: "Heckscher-Ohlin",
        q: "Erkl√§re das Heckscher-Ohlin-Theorem.",
        solution: "Es besagt, dass ein Land die G√ºter exportiert, f√ºr deren Produktion sein reichlich vorhandener Produktionsfaktor (Arbeit oder Kapital) intensiv genutzt wird, und die G√ºter importiert, bei denen der knappe Faktor intensiv ist.",
        keywords: [
          ["heckscher", "ohlin"],
          ["produktionsfaktor", "arbeit", "kapital"],
          ["reichlich", "relativ reich"],
          ["knapp", "relativ knapp"],
          ["exportiert", "importiert"]
        ]
      },
      {
        topic: "Heckscher-Ohlin",
        q: "Wie passt die Handelsg√ºterstruktur zwischen Deutschland und vielen asiatischen L√§ndern zum Heckscher-Ohlin-Theorem?",
        solution: "Deutschland mit viel Kapital exportiert vor allem kapitalintensive G√ºter wie Autos und Maschinen. Viele asiatische L√§nder mit viel Arbeitskraft exportieren eher arbeitsintensive G√ºter wie Textilien, Kleidung und einfachere Industriewaren.",
        keywords: [
          ["deutschland"],
          ["kapitalintensiv", "autos", "maschinen"],
          ["asiatisch", "asien"],
          ["arbeitsintensiv", "textilien", "kleidung"]
        ]
      },
      {
        topic: "Politisches System",
        q: "Was ist ein politisches System und welche drei Dimensionen unterscheidet man?",
        solution: "Ein politisches System umfasst die Strukturen, Prozesse und Inhalte, die das Zusammenleben im Staat regeln. Man unterscheidet Policy (Inhalte, Programme, Ziele), Politics (Prozesse, Konflikte, Wahlen) und Polity (Strukturen, Verfassung, Institutionen).",
        keywords: [
          ["strukturen", "prozesse", "inhalte"],
          ["zusammenleben", "staat"],
          ["policy", "programme", "ziele"],
          ["politics", "prozesse", "wahlen", "konflikte"],
          ["polity", "verfassung", "institutionen"]
        ]
      },
      {
        topic: "Geopolitik",
        q: "Was ist ein geopolitischer Schock? Nenne ein Beispiel und eine m√∂gliche wirtschaftliche Folge.",
        solution: "Ein geopolitischer Schock ist ein pl√∂tzliches politisch-√∂konomisches Ereignis mit starken wirtschaftlichen Folgen, z. B. Terroranschl√§ge, Kriege, Pandemien oder Handelskonflikte. Folgen k√∂nnen h√∂here Energiepreise, R√ºckzug ausl√§ndischer Investoren, Einbruch des Tourismus oder sinkender Konsum sein.",
        keywords: [
          ["geopolitisch"],
          ["schock", "krise"],
          ["terror", "krieg", "pandemie", "handelskonflikt", "zoll"],
          ["energiepreise", "investoren", "tourismus", "konsum"]
        ]
      },
      {
        topic: "Soziale Struktur",
        q: "Nenne verschiedene Dimensionen der Sozialstruktur eines Landes und jeweils ein Beispiel.",
        solution: "Dimensionen sind z. B. demografische Struktur (Altersstruktur, Fertilit√§tsrate, Abh√§ngigkeitsquote), Besch√§ftigung (Erwerbsbeteiligung, Besch√§ftigungsquote), Bildung (Bildungsstand), Ungleichheit (Gini, Armutsquote) und Gesundheit (Lebenserwartung, S√§uglings- und Suizidsterblichkeit).",
        keywords: [
          ["demografisch", "altersstruktur", "fertilit√§t", "abh√§ngigkeitsquote"],
          ["besch√§ftigung", "erwerbsbeteiligung"],
          ["bildung", "bildungsstand"],
          ["ungleichheit", "gini", "armutsquote"],
          ["gesundheit", "lebenserwartung", "s√§uglings", "suizid"]
        ]
      },
      {
        topic: "Ungleichheit",
        q: "Erkl√§re kurz Gini-Koeffizient und Armutsquote.",
        solution: "Der Gini-Koeffizient misst die Ungleichverteilung von Einkommen zwischen Haushalten (0 = gleich, 1 bzw. 100 = sehr ungleich). Die Armutsquote gibt an, wie viel Prozent der Bev√∂lkerung unterhalb der Armutsgrenze leben.",
        keywords: [
          ["gini"],
          ["ungleichverteilung", "einkommen"],
          ["armutsquote", "armut"],
          ["armutsgrenze", "unterhalb"]
        ]
      },
      {
        topic: "Dualistische Struktur",
        q: "Was ist eine dualistische Struktur in Wirtschaft und Gesellschaft? Nenne ein Beispiel.",
        solution: "Sie beschreibt das Nebeneinander eines modernen, produktiven, oft exportorientierten Sektors und eines traditionellen, wenig produktiven Sektors. Beispiel: High-Tech-St√§dte und wohlhabende K√ºstenregionen gegen√ºber armen, agrarisch gepr√§gten l√§ndlichen Regionen.",
        keywords: [
          ["dualistisch", "duale struktur"],
          ["modern", "exportorientiert"],
          ["traditionell", "agrarisch", "wenig produktiv"],
          ["beispiel", "stadt", "land", "k√ºstenregion"]
        ]
      },
      {
        topic: "Eisbergmodell",
        q: "Erkl√§re das Eisbergmodell der Kultur mit den Begriffen Perceptas und Conceptas.",
        solution: "Das Eisbergmodell zeigt, dass nur ein kleiner Teil der Kultur sichtbar ist (Perceptas wie Verhalten, Rituale, Geb√§ude), w√§hrend der gr√∂√üte Teil unsichtbar ist (Conceptas wie Werte, Normen, Denkweisen und Gef√ºhle), die das sichtbare Verhalten erkl√§ren.",
        keywords: [
          ["eisberg"],
          ["perceptas", "sichtbar", "verhalten", "rituale", "geb√§ude"],
          ["conceptas", "unsichtbar", "werte", "normen", "denkweisen", "gef√ºhle"]
        ]
      },
      {
        topic: "Asiatische Kultur",
        q: "Nenne Beispiele f√ºr asiatische Kultur und passende Werte dahinter.",
        solution: "Beispiele: K-Wave (K-Pop, Serien) steht f√ºr Attraktivit√§t und Modernit√§t; Essen mit St√§bchen und gemeinsames Essen f√ºr Gemeinschaft und Harmonie; langes Arbeiten und Leistungsdruck f√ºr Disziplin, Flei√ü und Bildungserfolg.",
        keywords: [
          ["k-wave", "kpop", "k-pop", "k-drama"],
          ["essen", "st√§bchen", "reis"],
          ["arbeit", "leistungsorientierung", "lange arbeitszeiten", "disziplin"],
          ["gemeinschaft", "harmonie", "familie"]
        ]
      },
      {
        topic: "Soft Power",
        q: "Definiere Soft Power und erkl√§re, wie S√ºdkorea sie mit der K-Wave nutzt.",
        solution: "Soft Power bedeutet, andere durch Attraktivit√§t von Kultur, Werten und Politik zu beeinflussen statt durch Zwang und milit√§rische oder wirtschaftliche Drohung (Hard Power). S√ºdkorea nutzt K-Pop, Serien, Mode und Essen, um das Land attraktiv zu machen und Tourismus, Spracherwerb und Konsum koreanischer Produkte zu f√∂rdern.",
        keywords: [
          ["soft power"],
          ["attraktivit√§t", "anziehung", "kultur", "werte"],
          ["kein zwang", "nicht milit√§risch", "hard power"],
          ["k-wave", "kpop", "k-pop", "k-drama"],
          ["tourismus", "produkte", "sprache"]
        ]
      },
      {
        topic: "Innovation",
        q: "Was misst die ‚ÄûTaxonomy of Economic Activities based on R&D Intensity‚Äú und was bedeutet technologische Intensit√§t?",
        solution: "Sie teilt Branchen nach ihrer Forschungs- und Entwicklungsintensit√§t ein, also danach, wie hoch die F&E-Ausgaben im Verh√§ltnis zur Wertsch√∂pfung sind. Technologische Intensit√§t beschreibt, wie stark ein Sektor auf Forschung, Entwicklung und Hightech basiert (High, Medium-High, Medium, Medium-Low, Low).",
        keywords: [
          ["taxonomy", "economic activities"],
          ["r&d", "f&e", "forschung", "entwicklung"],
          ["intensit√§t"],
          ["wertsch√∂pfung"],
          ["high tech", "high-tech", "technologisch"]
        ]
      }
    ];

    const avatars = ["üòº", "üòà", "ü§ì", "üò¥"];

    let index = 0;
    const userTexts = Array(questions.length).fill("");
    const userStatuses = Array(questions.length).fill(null);
    let scoreCorrect = 0, scorePartial = 0, scoreWrong = 0;

    let userName = "";
    let userAvatarIndex = 0;
    const comments = [];

    const topicPill = document.getElementById("topicPill");
    const counter = document.getElementById("counter");
    const statusPill = document.getElementById("statusPill");
    const questionText = document.getElementById("questionText");
    const userAnswer = document.getElementById("userAnswer");
    const resultBox = document.getElementById("resultBox");
    const resultText = document.getElementById("resultText");
    const solutionText = document.getElementById("solutionText");
    const checkBtn = document.getElementById("checkBtn");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const shuffleBtn = document.getElementById("shuffleBtn");
    const clearBtn = document.getElementById("clearBtn");
    const cardEl = document.getElementById("quizCard");
    const scoreCorrectEl = document.getElementById("scoreCorrect");
    const scorePartialEl = document.getElementById("scorePartial");
    const scoreWrongEl = document.getElementById("scoreWrong");
    const finishBtn = document.getElementById("finishBtn");

    const setupOverlay = document.getElementById("setupOverlay");
    const nameInput = document.getElementById("nameInput");
    const avatarGrid = document.getElementById("avatarGrid");
    const startQuizBtn = document.getElementById("startQuizBtn");
    const userInfoText = document.getElementById("userInfoText");
    const setupNameRow = document.getElementById("setupNameRow");
    const setupAvatarRow = document.getElementById("setupAvatarRow");
    const setupButtonRow = document.getElementById("setupButtonRow");
    const countdownDisplay = document.getElementById("countdownDisplay");

    const sumCorrectEl = document.getElementById("sumCorrect");
    const sumPartialEl = document.getElementById("sumPartial");
    const sumWrongEl = document.getElementById("sumWrong");
    const commentForm = document.getElementById("commentForm");
    const commentInput = document.getElementById("commentInput");
    const commentList = document.getElementById("commentList");

    function updateScores() {
      scoreCorrectEl.textContent = scoreCorrect;
      scorePartialEl.textContent = scorePartial;
      scoreWrongEl.textContent = scoreWrong;
      sumCorrectEl.textContent = scoreCorrect;
      sumPartialEl.textContent = scorePartial;
      sumWrongEl.textContent = scoreWrong;
    }

    function setStatusPill(status) {
      statusPill.className = "status-pill";
      if (!status) {
        statusPill.classList.add("status-none");
        statusPill.textContent = "";
        return;
      }
      statusPill.classList.remove("status-none");
      if (status === "correct") {
        statusPill.classList.add("status-correct");
        statusPill.textContent = "‚úÖ Richtig";
      } else if (status === "partial") {
        statusPill.classList.add("status-partial");
        statusPill.textContent = "üü° Teilweise";
      } else if (status === "wrong") {
        statusPill.classList.add("status-wrong");
        statusPill.textContent = "‚ùå Falsch";
      }
    }

    function renderQuestion() {
      const q = questions[index];
      topicPill.textContent = q.topic;
      counter.textContent = (index + 1) + " / " + questions.length;
      questionText.textContent = q.q;
      solutionText.textContent = q.solution;
      userAnswer.value = userTexts[index] || "";
      const status = userStatuses[index];
      setStatusPill(status);
      if (status) {
        resultBox.className = "result visible " + status;
        if (status === "correct") {
          resultText.textContent = "Stark, Kernpunkte getroffen ‚úÖ";
        } else if (status === "partial") {
          resultText.textContent = "Teilweise richtig ‚Äì ein, zwei Kernbegriffe fehlen noch.";
        } else {
          resultText.textContent = "Noch nicht ganz ‚Äì vergleiche mit der Musterl√∂sung.";
        }
      } else {
        resultBox.className = "result";
        resultText.textContent = "";
      }
    }

    function evaluateAnswer() {
      const q = questions[index];
      const answer = (userAnswer.value || "").toLowerCase();
      userTexts[index] = userAnswer.value;

      if (!answer.trim()) {
        alert("Schreib zuerst eine Antwort, bevor du pr√ºfst üòâ");
        return;
      }

      let hitGroups = 0;
      q.keywords.forEach(group => {
        if (group.some(kw => answer.includes(kw))) {
          hitGroups++;
        }
      });

      const totalGroups = q.keywords.length;
      let status;
      if (hitGroups === 0) {
        status = "wrong";
      } else if (hitGroups === 1 || hitGroups / totalGroups < 0.5) {
        status = "partial";
      } else {
        status = "correct";
      }

      const prevStatus = userStatuses[index];
      if (prevStatus !== status) {
        if (prevStatus === "correct") scoreCorrect--;
        if (prevStatus === "partial") scorePartial--;
        if (prevStatus === "wrong") scoreWrong--;

        if (status === "correct") scoreCorrect++;
        if (status === "partial") scorePartial++;
        if (status === "wrong") scoreWrong++;
        updateScores();
      }

      userStatuses[index] = status;
      setStatusPill(status);
      resultBox.className = "result visible " + status;

      if (status === "correct") {
        resultText.textContent = "Stark, Kernpunkte getroffen ‚úÖ";
      } else if (status === "partial") {
        resultText.textContent = "Teilweise richtig ‚Äì ein, zwei Kernbegriffe fehlen noch.";
      } else {
        resultText.textContent = "Noch nicht ganz ‚Äì vergleiche mit der Musterl√∂sung.";
      }
    }

    function nextQuestion() {
      index = (index + 1) % questions.length;
      renderQuestion();
      userAnswer.focus();
    }

    function prevQuestion() {
      index = (index - 1 + questions.length) % questions.length;
      renderQuestion();
      userAnswer.focus();
    }

    function shuffleQuestions() {
      for (let i = questions.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [questions[i], questions[j]] = [questions[j], questions[i]];
        [userTexts[i], userTexts[j]] = [userTexts[j], userTexts[i]];
        [userStatuses[i], userStatuses[j]] = [userStatuses[j], userStatuses[i]];
      }
      index = 0;
      renderQuestion();
      userAnswer.focus();
    }

    function renderComments() {
      commentList.innerHTML = "";
      if (comments.length === 0) {
        const empty = document.createElement("div");
        empty.style.fontSize = "0.75rem";
        empty.style.color = "#6b7280";
        empty.textContent = "Noch keine Kommentare ‚Äì beende das Quiz und poste den ersten üöÄ";
        commentList.appendChild(empty);
        return;
      }
      comments.slice().reverse().forEach(c => {
        const item = document.createElement("div");
        item.className = "comment-item";

        const avatar = document.createElement("div");
        avatar.className = "comment-avatar";
        avatar.textContent = avatars[c.avatarIndex] || "üôÇ";

        const body = document.createElement("div");
        body.className = "comment-body";

        const metaRow = document.createElement("div");
        metaRow.className = "comment-meta";

        const nameSpan = document.createElement("div");
        nameSpan.className = "comment-name";
        nameSpan.textContent = c.name;

        const scoreSpan = document.createElement("div");
        scoreSpan.className = "comment-score";
        scoreSpan.textContent = `Score: ‚úÖ ${c.correct} ‚Ä¢ üü° ${c.partial} ‚Ä¢ ‚ùå ${c.wrong}`;

        metaRow.appendChild(nameSpan);
        metaRow.appendChild(scoreSpan);

        const textDiv = document.createElement("div");
        textDiv.className = "comment-text";
        textDiv.textContent = c.text;

        const timeDiv = document.createElement("div");
        timeDiv.className = "comment-timestamp";
        timeDiv.textContent = c.timeLabel;

        body.appendChild(metaRow);
        body.appendChild(textDiv);
        body.appendChild(timeDiv);

        item.appendChild(avatar);
        item.appendChild(body);
        commentList.appendChild(item);
      });
    }

    avatarGrid.addEventListener("click", (e) => {
      const option = e.target.closest(".avatar-option");
      if (!option) return;
      const idx = parseInt(option.dataset.index, 10);
      userAvatarIndex = isNaN(idx) ? 0 : idx;
      document.querySelectorAll(".avatar-option").forEach(el => el.classList.remove("selected"));
      option.classList.add("selected");
    });

    startQuizBtn.addEventListener("click", () => {
      const n = nameInput.value.trim();
      if (!n) {
        alert("Bitte gib deinen Namen ein, damit man sp√§ter sieht, wer kommentiert.");
        return;
      }
      userName = n;
      userInfoText.textContent = `Angemeldet als ${userName} ${avatars[userAvatarIndex]} ‚Äì deine Kommentare erscheinen mit Name & Avatar.`;

      setupNameRow.style.display = "none";
      setupAvatarRow.style.display = "none";
      setupButtonRow.style.display = "none";
      countdownDisplay.style.display = "block";

      let count = 3;
      countdownDisplay.textContent = count;

      const interval = setInterval(() => {
        count--;
        if (count > 0) {
          countdownDisplay.textContent = count;
        } else {
          countdownDisplay.textContent = "Start!";
          clearInterval(interval);
          setTimeout(() => {
            setupOverlay.style.display = "none";
            userAnswer.focus();
          }, 600);
        }
      }, 700);
    });

    commentForm.addEventListener("submit", (e) => {
      e.preventDefault();
      if (!userName) {
        alert("Name fehlt ‚Äì bitte Seite neu laden und zuerst Setup ausf√ºllen.");
        return;
      }
      const text = (commentInput.value || "").trim();
      if (!text) {
        alert("Schreib erst einen kurzen Kommentar üòâ");
        return;
      }
      const now = new Date();
      const timeLabel = now.toLocaleString("de-DE", {
        hour: "2-digit",
        minute: "2-digit",
        day: "2-digit",
        month: "2-digit"
      });

      comments.push({
        name: userName,
        avatarIndex: userAvatarIndex,
        correct: scoreCorrect,
        partial: scorePartial,
        wrong: scoreWrong,
        text,
        timeLabel
      });
      commentInput.value = "";
      renderComments();
    });

    checkBtn.addEventListener("click", evaluateAnswer);
    nextBtn.addEventListener("click", nextQuestion);
    prevBtn.addEventListener("click", prevQuestion);
    shuffleBtn.addEventListener("click", shuffleQuestions);
    clearBtn.addEventListener("click", () => {
      userAnswer.value = "";
      userTexts[index] = "";
      userStatuses[index] = null;
      renderQuestion();
      userAnswer.focus();
    });

    finishBtn.addEventListener("click", () => {
      alert("Dein aktueller Score ist rechts zu sehen. Wenn du willst, schreib jetzt einen Kommentar und poste ihn ‚úÖ");
      updateScores();
      commentInput.focus();
    });

    document.addEventListener("keydown", (e) => {
      if (setupOverlay.style.display !== "none") return;
      if (e.key === "ArrowRight") nextQuestion();
      if (e.key === "ArrowLeft") prevQuestion();
      if (e.key === "Enter" && (e.metaKey || e.ctrlKey)) {
        e.preventDefault();
        evaluateAnswer();
      }
    });

    let startX = null;
    cardEl.addEventListener("touchstart", (e) => {
      startX = e.touches[0].clientX;
    });
    cardEl.addEventListener("touchend", (e) => {
      if (startX === null) return;
      const endX = e.changedTouches[0].clientX;
      const diff = endX - startX;
      if (Math.abs(diff) > 50) {
        if (diff < 0) nextQuestion();
        else prevQuestion();
      }
      startX = null;
    });

    renderQuestion();
    updateScores();
    renderComments();
  </script>
</body>
</html>
